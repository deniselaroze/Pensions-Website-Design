dplyr::select(correct_response, Treatments)  %>%
ggplot(aes(y = correct_response, x = as.factor(Treatments), color=Treatments)) +
geom_boxplot() +
geom_hline(aes(yintercept = h), linetype = 2, color = "gray") +
geom_text(aes(y=h+0.5, label=paste0("Mean ", prettyNum(h,big.mark=",")), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
scale_y_continuous(breaks = seq(0, 7, 1), limits = c(0,12)) +
theme_gppr() +
scale_colour_brewer(type = "seq", palette = "Dark2")+
labs(x ="", y = "Num. Correct Response", title = "")  +
theme(axis.title.y = element_text(vjust = +3),
axis.ticks.x = element_blank(),
plot.title = element_text(vjust = -1, size = 12),
legend.position="none") +
ggpubr::stat_compare_means(comparisons = my_comparisons,
label = "p.signif", method = "wilcox.test")
ggsave(paste0(path_github,"online/Graphs/responses.pdf"))
### Correct responses Gender Het
h <- round(mean(df.g$correct_response, na.rm = TRUE), digits = 1)
df.g %>%
ggplot(aes(y = correct_response, x = Treatments, color = Gender)) +
geom_boxplot() +
ylab("Num. Correct Responses") +
geom_hline(aes(yintercept = h), linetype = 2, color = "gray") +
geom_text(aes(y=h+0.5, label=paste0("Mean ", prettyNum(h,big.mark=",")), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
theme_gppr() +
ggsci::scale_color_jco() +
stat_compare_means(aes(group = Gender), label = "p.signif")+
theme(axis.title.y = element_text(vjust = +3),
plot.title = element_text(vjust = -1, size = 12),
#axis.ticks.x = element_blank(),
#axis.title.x = element_blank()
) +
scale_y_continuous(breaks = seq(0, 7, 1), limits = c(0,8))
ggsave(paste0(path_github,"online/Graphs/responses_het_gender.pdf"))
### Correct Responses Heterogeneity Public/Private
h_res <- round(mean(df.g$correct_response, na.rm = TRUE), digits = 1)
df.g %>%
dplyr::select(correct_response, Treatments, Pension_Type)  %>%
ggplot(aes(y = correct_response, x = as.factor(Treatments), color = Pension_Type)) +
geom_boxplot() +
geom_hline(aes(yintercept = h_res), linetype = 2, color = "gray") +
geom_text(aes(y=h_res+0.5, label=paste0("Mean ", prettyNum(h_res,big.mark=",")), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
scale_y_continuous(breaks = seq(0, 7, 1), limits = c(0,8)) +
theme_gppr() +
scale_colour_brewer(type = "seq", palette = "Dark2", name = "Type of Pension")+
labs(x ="", y = "Num. Correct Response", title = "")  +
theme(axis.title.y = element_text(vjust = +3),
axis.ticks.x = element_blank(),
plot.title = element_text(vjust = -1, size = 12)) +
stat_compare_means(aes(group = Pension_Type), label = "p.signif")
ggsave(paste0(path_github,"online/Graphs/responses_het_pensiontype.pdf"))
#### Self reported measures
##########################################################
###### Confidence
h_co <- round(mean(as.numeric(df.g$Confidence), na.rm = TRUE), digits = 1)
df.g %>%
ggplot(aes(y = as.numeric(df.g$Confidence), x = as.factor(Treatments), color = Treatments)) +
geom_boxplot() +
geom_hline(aes(yintercept = h_co), linetype = 2, color = "gray") +
geom_text(aes(y=h_co+0.5, label=paste0("Mean ", prettyNum(h_co,big.mark=",")), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
scale_y_continuous(breaks = seq(0, 10, 2), limits = c(0,12)) +
theme_gppr() +
ggsci::scale_color_aaas() +
ggsci::scale_fill_aaas() +
ggpubr::stat_compare_means(comparisons = my_comparisons,
label = "p.signif", method = "wilcox.test")+
labs(x ="", y = "", title = "Confidence")  +
theme(axis.text.x=element_blank(),
axis.title.y = element_text(vjust = +6),
plot.title = element_text(vjust = -1, size = 12),
axis.ticks.x = element_blank())
###### overconfidence
df.g %>%
ggplot(aes(y = overconfidence, x = as.factor(Treatments), color = Treatments)) +
geom_boxplot() +
geom_hline(aes(yintercept = 0), linetype = 2, color = "gray") +
#scale_y_continuous(limits = c(0,0.2)) +
theme_gppr() +
ggsci::scale_color_aaas() +
ggsci::scale_fill_aaas() +
ggpubr::stat_compare_means(comparisons = my_comparisons,
label = "p.signif", method = "wilcox.test")+
labs(x ="", y = "Overconfidence", title = "")  +
theme(legend.position="none",
#axis.title.y = element_text(vjust = +6),
#plot.title = element_text(vjust = -1, size = 12),
axis.ticks.x = element_blank())
ggsave(paste0(path_github,"online/Graphs/overconfidence.pdf"))
#over confidence gender
df.g %>%
ggplot(aes(y = overconfidence, x = Treatments, color = Gender)) +
geom_boxplot() +
#geom_point(position = position_jitterdodge()) +
ylab("Overconfidence") + xlab("") +
geom_hline(aes(yintercept = 0), linetype = 2, color = "gray") +
theme_gppr() +
ggsci::scale_color_jco() +
stat_compare_means(aes(group = Gender), label = "p.signif")+
theme(#axis.text.x=element_blank(),
axis.title.y = element_text(vjust = +3),
plot.title = element_text(vjust = -1, size = 12),
axis.ticks.x = element_blank(),
axis.title.x = element_blank()) #+
#scale_y_continuous(limits = c(0,0.15))
ggsave(paste0(path_github,"online/Graphs/overconfidence_het_gender.pdf"))
#Promoter
df.g %>%
ggplot(aes(y = overconfidence, x = as.factor(Treatments), color = Treatments)) +
geom_boxplot() +
geom_hline(aes(yintercept = 0), linetype = 2, color = "gray") +
#scale_y_continuous(limits = c(0,0.2)) +
theme_gppr() +
scale_colour_brewer(type = "seq", palette = "Dark2")+
ggpubr::stat_compare_means(comparisons = my_comparisons,
label = "p.signif", method = "wilcox.test")+
labs(x ="", y = "Overconfidence", title = "")  +
theme(legend.position="none",
#axis.title.y = element_text(vjust = +6),
#plot.title = element_text(vjust = -1, size = 12),
axis.ticks.x = element_blank())
ggsave(paste0(path_github,"online/Graphs/overconfidence.pdf"))
df.g %>%
ggplot(aes(y = overconfidence, x = as.factor(Treatments), color = Treatments)) +
geom_boxplot() +
geom_hline(aes(yintercept = 0), linetype = 2, color = "gray") +
#scale_y_continuous(limits = c(0,0.2)) +
theme_gppr() +
scale_colour_brewer(type = "seq", palette = "Dark2")+
ggpubr::stat_compare_means(comparisons = my_comparisons,
label = "p.signif", method = "wilcox.test")+
labs(x ="", y = "Overconfidence", title = "")  +
theme(legend.position="none",
#axis.title.y = element_text(vjust = +6),
#plot.title = element_text(vjust = -1, size = 12),
axis.ticks.x = element_blank())
ggsave(paste0(path_github,"online/Graphs/overconfidence.pdf"))
p <- df %>%
group_by(Treatments) %>%
summarise(out = sum(OptOut =="Out", na.rm=T),
n = n()) %>%
rowwise() %>%
mutate(tst = list(broom::tidy(prop.test(out, n, conf.level = 0.95)))) %>%
tidyr::unnest(tst)
prop_test<-p[-5,]
View(prop_test)
p <- df %>%
group_by(Treatments, Pension_Type) %>%
summarise(out = sum(OptOut =="Out", na.rm=T),
n = n()) %>%
rowwise() %>%
mutate(tst = list(broom::tidy(prop.test(out, n, conf.level = 0.95)))) %>%
tidyr::unnest(tst)
prop_test<-p[-5,]
View(p)
p <- df %>%
group_by(Treatments, Pension_Type) %>%
summarise(out = sum(OptOut =="Out", na.rm=T),
n = n()) %>%
rowwise() %>%
mutate(tst = list(broom::tidy(prop.test(out, n, conf.level = 0.95)))) %>%
tidyr::unnest(tst)
prop_test<-p[-8,]
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, fill = Pension_Type)) +
geom_bar(stat="identity") +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high)) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(), axis.text.x=element_blank()) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out")
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, fill = Pension_Type)) +
geom_bar(stat="identity") +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high)) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(), axis.text.x=element_blank()) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out") + facet_wrap(Pension_type)
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, fill = Pension_Type)) +
geom_bar(stat="identity") +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high)) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(), axis.text.x=element_blank()) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out") + facet_wrap(prop_test$Pension_type)
View(prop_test)
p <- df %>%
group_by(Treatments, Pension_Type) %>%
summarise(out = sum(OptOut =="Out", na.rm=T),
n = n()) %>%
rowwise() %>%
mutate(tst = list(broom::tidy(prop.test(out, n, conf.level = 0.95)))) %>%
tidyr::unnest(tst)
prop_test<-p[-9,]
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, fill = Pension_Type)) +
geom_bar(stat="identity") +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high)) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(), axis.text.x=element_blank()) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out") + facet_wrap(prop_test$Pension_type)
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, fill = Pension_Type)) +
geom_bar(stat="identity", position= dodge) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high)) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(), axis.text.x=element_blank()) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out") + facet_wrap(prop_test$Pension_type)
p <- df %>%
group_by(Treatments, Pension_Type) %>%
summarise(out = sum(OptOut =="Out", na.rm=T),
n = n()) %>%
rowwise() %>%
mutate(tst = list(broom::tidy(prop.test(out, n, conf.level = 0.95)))) %>%
tidyr::unnest(tst)
prop_test<-p[-9,]
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, fill = Pension_Type)) +
geom_bar(stat="identity", position= dodge) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high)) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(), axis.text.x=element_blank()) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out")
p <- df %>%
group_by(Treatments) %>%
summarise(out = sum(OptOut =="Out", na.rm=T),
n = n()) %>%
rowwise() %>%
mutate(tst = list(broom::tidy(prop.test(out, n, conf.level = 0.95)))) %>%
tidyr::unnest(tst)
prop_test<-p[-5,]
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, fill = Treatments)) +
geom_bar(stat="identity") +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high)) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank()) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out")
ggsave(paste0(path_github,"online/Graphs/OptOut.pdf"))
p <- df %>%
group_by(Treatments, Pension_Type) %>%
summarise(out = sum(OptOut =="Out", na.rm=T),
n = n()) %>%
rowwise() %>%
mutate(tst = list(broom::tidy(prop.test(out, n, conf.level = 0.95)))) %>%
tidyr::unnest(tst)
prop_test<-p[-9,]
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, color = Pension_Type)) +
geom_bar(stat="identity", position= dodge) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high)) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(),) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out")
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, color = Pension_Type)) +
geom_bar(stat="identity", position= dodge) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high , position_dodge2(preserve = "single"))) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(),) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out")
p <- df %>%
group_by(Treatments, Pension_Type) %>%
summarise(out = sum(OptOut =="Out", na.rm=T),
n = n()) %>%
rowwise() %>%
mutate(tst = list(broom::tidy(prop.test(out, n, conf.level = 0.95)))) %>%
tidyr::unnest(tst)
prop_test<-p[-9,]
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, color = Pension_Type)) +
geom_bar(stat="identity", position= position_dodge2(preserve = "single")) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high , position_dodge2(preserve = "single"))) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(),) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out")
p <- df %>%
group_by(Treatments, Pension_Type) %>%
summarise(out = sum(OptOut =="Out", na.rm=T),
n = n()) %>%
rowwise() %>%
mutate(tst = list(broom::tidy(prop.test(out, n, conf.level = 0.95)))) %>%
tidyr::unnest(tst)
prop_test<-p[-9,]
View(prop_test)
p <- df %>%
group_by(Treatments, Pension_Type) %>%
summarise(out = sum(OptOut =="Out", na.rm=T),
n = n()) %>%
rowwise() %>%
mutate(tst = list(broom::tidy(prop.test(out, n, conf.level = 0.95)))) %>%
tidyr::unnest(tst)
prop_test<-p[-9,]
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, color = Pension_Type)) +
geom_bar(stat="identity", position= position_dodge2()) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high , position_dodge2())) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(),) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out")
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, color = Pension_Type)) +
geom_bar(stat="identity", position= position_dodge2()) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high ,  position=position_dodge2())) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(),) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out")
p <- df %>%
group_by(Treatments, Pension_Type) %>%
summarise(out = sum(OptOut =="Out", na.rm=T),
n = n()) %>%
rowwise() %>%
mutate(tst = list(broom::tidy(prop.test(out, n, conf.level = 0.95)))) %>%
tidyr::unnest(tst)
prop_test<-p[-9,]
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, color = Pension_Type)) +
geom_bar(stat="identity", position= "dodge2") +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high ,  position="dodge2")) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(),) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out")
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, color = Pension_Type, fill =Pension_Type)) +
geom_bar(stat="identity", position= "dodge2") +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high ,  position="dodge2")) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(),) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out")
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, color = Pension_Type, fill =Pension_Type)) +
geom_bar(stat="identity", position= "dodge2") +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high ,  position="dodge2"),  color = Pension_Type) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(),) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out")
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, color = Pension_Type, fill =Pension_Type)) +
geom_bar(stat="identity", position= "dodge2") +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high ,  position="dodge2",  color = Pension_Type)) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(),) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out")
prop_test %>%
ggplot(aes(x=Treatments, y=estimate, color = Pension_Type, fill =Pension_Type)) +
geom_bar(stat="identity", position= "dodge2",  color = Pension_Type) +
geom_errorbar(aes(ymin=conf.low, ymax = conf.high ,  position="dodge2",  color = Pension_Type)) +
theme_gppr() +
ggsci::scale_fill_aaas() +
scale_y_continuous(breaks = seq(0, 1, 0.2), limits = c(0,1)) +
theme(axis.title.x=element_blank(),) +
geom_hline(aes(yintercept = 0.2), linetype = 2, color = "gray") +
geom_text(aes(y=0.2, label=paste0("0.2"), x=0.1), colour='gray', hjust=-0.1 , vjust = 1) +
ylab("Opt Out")
p <- df %>%
group_by(Treatments, Pension_Type) %>%
summarise(out = sum(OptOut =="Out", na.rm=T),
n = n()) %>%
rowwise() %>%
mutate(tst = list(broom::tidy(prop.test(out, n, conf.level = 0.95)))) %>%
tidyr::unnest(tst)
prop_test<-p[-9,]
View(prop_test)
################################
#### Ideas to test - not clean
#### author: Denise Laroze
################################
library(stargazer)
library(MASS)
library(broom)
library(ggpubr)
#library(naniar)
#path_datos <- "C:/Users/Usuario/Documents/INVESTIGACION/MiInvestigacion/Pensions-Website-Design/"
path_datos <- "C:/Users/Denise Laroze/Dropbox/Sitios web/Datos Estudio Online/"
#path_datos <- "C:/Users/Profesor/Dropbox/Sitios web/Datos Estudio Online/"
# If you don´t use Rprojects functionality setwd
#setwd("C:/Users/Usuario/Documents/INVESTIGACION/MiInvestigacion/Pensions-Website-Design/")
#path_github <- "C:/Users/Usuario/Documents/INVESTIGACION/MiInvestigacion/Pensions-Website-Design/Pilots/Superintendencia_de_Pensiones"
path_github <- "C:/Users/Denise Laroze/Documents/GitHub/Pensions Website Design/"
#path_github <- "C:/Users/Profesor/Documents/GitHub/Pensions-Website-Design/"
################################
#### Ideas to test - not clean
#### author: Denise Laroze
################################
library(stargazer)
library(MASS)
library(broom)
library(ggpubr)
#library(naniar)
#path_datos <- "C:/Users/Usuario/Documents/INVESTIGACION/MiInvestigacion/Pensions-Website-Design/"
path_datos <- "C:/Users/Denise Laroze/Dropbox/Sitios web/Datos Estudio Online/"
#path_datos <- "C:/Users/Profesor/Dropbox/Sitios web/Datos Estudio Online/"
# If you don´t use Rprojects functionality setwd
#setwd("C:/Users/Usuario/Documents/INVESTIGACION/MiInvestigacion/Pensions-Website-Design/")
#path_github <- "C:/Users/Usuario/Documents/INVESTIGACION/MiInvestigacion/Pensions-Website-Design/Pilots/Superintendencia_de_Pensiones"
path_github <- "C:/Users/Denise Laroze/Documents/GitHub/Pensions Website Design/"
#path_github <- "C:/Users/Profesor/Documents/GitHub/Pensions-Website-Design/"
source(paste0(path_github,"Online/R/paquetes.R"))
source(paste0(path_github,"Online/R/funciones.R"))
#source(paste0(path_github,"Online/R/etl_surveys.R"))
#source(paste0(path_github,"Online/R/etl_sites.R"))
#source(paste0(path_github,"Online/R/etl_complete.R"))
df <- readRDS(paste0(path_datos, "online_data.rds"))
##############################
########### Data Management
##############################
#Overconfidence
df$Confidence<-as.numeric(df$Confidence_1)
df$overconfidence<- (df$Confidence/10) / (df$correct_response/7)
View(df[, c("correct_response", "Confidence", "overconfidence")])
#Change opinion about advisor
df$Change_Advisor<-ifelse(df$PAdvice=="No" & df$Advisor=="No", "Maintain No",
ifelse (df$PAdvice=="No" & df$Advisor=="Sí", "> advisor",
ifelse(df$PAdvice=="Sí" & df$Advisor=="Sí", "Maintain Yes",
ifelse(df$PAdvice=="Sí" & df$Advisor=="No", "< advisor",
ifelse(df$PAdvice=="No lo ha pensado" & df$Advisor=="Sí", "> advisor",
ifelse(df$PAdvice=="No lo ha pensado" & df$Advisor=="No", "< advisor", "Error"
))))))
df$pb_d<-ifelse(df$present_bias>19999, "alto", "bajo")
### Alternative Financial Literacy
### Correct answers for Finantial Literacy Questions
#table(DF$QMath1)
df$QMath1b_correct<-ifelse(df$QMath1=="Más de $125.000.000",  1,
ifelse(is.na(df$QMath1), NA, 0))
#table(DF$QMath1, DF$QMath1_correct)
#table(DF$QMath2)
df$QMath2b_correct<-ifelse(df$QMath2=="Nunca se terminaría de pagar el crédito", 1,
ifelse(is.na(df$QMath1), NA, 0))
#table(DF$QMath2, DF$QMath2_correct)
tmp<-df[, c("QMath1b_correct", "QMath2b_correct") ]
tmp$financial_lit_b<-rowSums(tmp)
df$financial_lit_b<-tmp$financial_lit_b
rm(tmp)
###############################
df.f<-df[!is.na(df$correct_response),]
prop.table(table(df.f$genero))
names(df.f)
prop.table(table(df.f$Birth))
describe(df.f$Birth)
summary(df.f$Birth)
summary(as.numeric(df.f$Birth))
summary(2022-as.numeric(df.f$Birth))
prop.table(table(df.f$Educ))
prop.table(table(df.f$Tram_jubilacion))
df.pv<-df[df$Pension_Type=="Private",]
df.pp<-df[df$Pension_Type=="Public",]
df.pv<-df[df.f$Pension_Type=="Private",]
df.pv<-df[df.f$Pension_Type=="Private",]
table(df.f$Pension_Type)
192+258
